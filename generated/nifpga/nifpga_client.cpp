
//---------------------------------------------------------------------
// This file is automatically generated. All manual edits will be lost.
//---------------------------------------------------------------------
// EXPERIMENTAL Client convenience wrapper for NI-FPGA.
//---------------------------------------------------------------------
#include "nifpga_client.h"

#include <grpcpp/grpcpp.h>

#include <nifpga.grpc.pb.h>

#include <cstdint>
#include <memory>
#include <stdexcept>
#include <vector>

namespace nifpga_grpc::experimental::client {

InitializeResponse
initialize(const StubPtr& stub)
{
  ::grpc::ClientContext context;

  auto request = InitializeRequest{};

  auto response = InitializeResponse{};

  raise_if_error(
      stub->Initialize(&context, request, &response));

  return response;
}

FinalizeResponse
finalize(const StubPtr& stub)
{
  ::grpc::ClientContext context;

  auto request = FinalizeRequest{};

  auto response = FinalizeResponse{};

  raise_if_error(
      stub->Finalize(&context, request, &response));

  return response;
}

OpenResponse
open(const StubPtr& stub, const pb::string& bitfile, const pb::string& signature, const pb::string& resource, const simple_variant<OpenAttribute, std::int32_t>& attribute)
{
  ::grpc::ClientContext context;

  auto request = OpenRequest{};
  request.set_bitfile(bitfile);
  request.set_signature(signature);
  request.set_resource(resource);
  const auto attribute_ptr = attribute.get_if<OpenAttribute>();
  const auto attribute_raw_ptr = attribute.get_if<std::int32_t>();
  if (attribute_ptr) {
    request.set_attribute_mapped(*attribute_ptr);
  }
  else if (attribute_raw_ptr) {
    request.set_attribute_raw(*attribute_raw_ptr);
  }

  auto response = OpenResponse{};

  raise_if_error(
      stub->Open(&context, request, &response));

  return response;
}

CloseResponse
close(const StubPtr& stub, const nidevice_grpc::Session& session, const pb::uint32& attribute)
{
  ::grpc::ClientContext context;

  auto request = CloseRequest{};
  request.mutable_session()->CopyFrom(session);
  request.set_attribute(attribute);

  auto response = CloseResponse{};

  raise_if_error(
      stub->Close(&context, request, &response));

  return response;
}


} // namespace nifpga_grpc::experimental::client
